<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LumenAGI Mission Control</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: #0a0a0f;
            color: #e0e0e0;
            min-height: 100vh;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #2a2a3a;
        }
        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        .logo h1 { font-size: 1.5rem; color: #fff; }
        .logo span { color: #ff6b35; }
        .status-badge {
            background: #1a1a2e;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.85rem;
        }
        .status-badge.online { border: 1px solid #00ff88; color: #00ff88; }
        .status-badge.offline { border: 1px solid #ff4444; color: #ff4444; }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .card {
            background: #12121a;
            border-radius: 12px;
            padding: 20px;
            border: 1px solid #2a2a3a;
        }
        .card h2 {
            font-size: 1rem;
            color: #888;
            margin-bottom: 15px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        .card .value {
            font-size: 2.5rem;
            font-weight: bold;
            color: #fff;
        }
        .card .unit { font-size: 1rem; color: #666; }
        .card .note { font-size: 0.8rem; color: #666; margin-top: 8px; }
        .card .live { 
            font-size: 0.75rem; 
            color: #00ff88; 
            display: flex; 
            align-items: center; 
            gap: 5px;
            margin-top: 8px;
        }
        .card .live::before {
            content: '';
            width: 6px;
            height: 6px;
            background: #00ff88;
            border-radius: 50%;
            animation: pulse 1.5s infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }

        /* Agents Grid */
        .agents-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }
        .agent-card {
            background: #1a1a2e;
            border-radius: 10px;
            padding: 15px;
            border-left: 4px solid #666;
        }
        .agent-card.active { border-left-color: #00ff88; }
        .agent-card.idle { border-left-color: #ffaa00; }
        .agent-card.offline { border-left-color: #ff4444; }
        .agent-card h3 { font-size: 1rem; margin-bottom: 8px; }
        .agent-card .role { font-size: 0.8rem; color: #888; }
        .agent-card .metrics {
            margin-top: 10px;
            font-size: 0.85rem;
            display: flex;
            justify-content: space-between;
        }

        /* Activity Feed */
        .activity-feed {
            max-height: 400px;
            overflow-y: auto;
        }
        .activity-item {
            padding: 12px;
            border-bottom: 1px solid #2a2a3a;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .activity-item .time { color: #666; font-size: 0.8rem; }

        /* GPU Monitor */
        .gpu-bar {
            height: 20px;
            background: #1a1a2e;
            border-radius: 10px;
            overflow: hidden;
            margin-top: 10px;
        }
        .gpu-bar .fill {
            height: 100%;
            background: linear-gradient(90deg, #00ff88, #00aa55);
            transition: width 0.3s;
        }
        .gpu-bar .fill.warning { background: linear-gradient(90deg, #ffaa00, #ff6600); }
        .gpu-bar .fill.critical { background: linear-gradient(90deg, #ff4444, #cc0000); }

        /* System Info */
        .system-info {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            font-size: 0.85rem;
        }
        .system-info div {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #2a2a3a;
        }
        .system-info .label { color: #888; }
        .system-info .value { color: #fff; }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">
                <h1>Lumen<span>AGI</span> Mission Control</h1>
            </div>
            <div class="status-badge online" id="system-status">üü¢ System Online</div>
        </header>

        <!-- Key Metrics -->
        <div class="grid">
            <div class="card">
                <h2>GPU Memory</h2>
                <div class="value"><span id="gpu-used">0.5</span><span class="unit">GB</span></div>
                <div class="note"><span id="gpu-free">23.5</span> GB free</div>
                <div class="gpu-bar">
                    <div class="fill" id="gpu-fill" style="width: 2%;"></div>
                </div>
                <div class="live">LIVE</div>
            </div>
            <div class="card">
                <h2>GPU Temp</h2>
                <div class="value"><span id="gpu-temp">45</span><span class="unit">¬∞C</span></div>
                <div class="note">Utilization: <span id="gpu-util">3</span>%</div>
            </div>
            <div class="card">
                <h2>Active Agents</h2>
                <div class="value">6</div>
                <div class="note">1 active, 5 idle</div>
            </div>
            <div class="card">
                <h2>Heartbeat</h2>
                <div class="value" style="color: #00ff88;">30<span class="unit">min</span></div>
                <div class="note">Next check: <span id="next-check">--</span></div>
            </div>
        </div>

        <!-- System Status -->
        <div class="card" style="margin-bottom: 20px;">
            <h2>System Status</h2>
            <div class="system-info">
                <div><span class="label">Model</span><span class="value" id="sys-model">Pony-Alpha</span></div>
                <div><span class="label">Provider</span><span class="value" id="sys-provider">OpenRouter</span></div>
                <div><span class="label">Gateway</span><span class="value" id="sys-gateway">127.0.0.1:18789</span></div>
                <div><span class="label">Channels</span><span class="value" id="sys-channels">Telegram, Moltbook</span></div>
            </div>
        </div>

        <!-- Agents Status -->
        <div class="card" style="margin-bottom: 20px;">
            <h2>SWARM Agents</h2>
            <div class="agents-grid" id="agents-grid">
                <!-- Filled by JS -->
            </div>
        </div>

        <!-- Activity Feed -->
        <div class="card">
            <h2>Recent Activity</h2>
            <div class="activity-feed" id="activity-feed">
                <!-- Filled by JS -->
            </div>
        </div>
    </div>

    <script>
        // Fetch all data from API
        async function fetchData() {
            try {
                const response = await fetch('/api/all');
                const data = await response.json();
                updateUI(data);
            } catch (error) {
                console.error('Failed to fetch:', error);
            }
        }

        function updateUI(data) {
            // GPU
            const gpu = data.gpu;
            document.getElementById('gpu-used').textContent = gpu.used_gb.toFixed(1);
            document.getElementById('gpu-free').textContent = gpu.free_gb.toFixed(1);
            document.getElementById('gpu-temp').textContent = gpu.temperature;
            document.getElementById('gpu-util').textContent = gpu.utilization;
            
            const percent = (gpu.used_gb / gpu.total_gb) * 100;
            const fill = document.getElementById('gpu-fill');
            fill.style.width = percent + '%';
            fill.className = 'fill';
            if (percent > 80) fill.classList.add('critical');
            else if (percent > 60) fill.classList.add('warning');

            // System
            const status = data.status;
            document.getElementById('sys-model').textContent = status.model;
            document.getElementById('sys-provider').textContent = status.provider;
            document.getElementById('sys-gateway').textContent = status.gateway;
            document.getElementById('sys-channels').textContent = status.channels.join(', ');

            // Agents
            const agentsGrid = document.getElementById('agents-grid');
            agentsGrid.innerHTML = data.agents.map(agent => `
                <div class="agent-card ${agent.status}">
                    <h3>${getAgentEmoji(agent.name)} ${agent.name}</h3>
                    <div class="role">${agent.role}</div>
                    <div class="metrics">
                        <span>${agent.status}</span>
                        <span>${agent.model}</span>
                    </div>
                </div>
            `).join('');

            // Activity
            const activityFeed = document.getElementById('activity-feed');
            activityFeed.innerHTML = data.activity.map(item => `
                <div class="activity-item">
                    <span>${item.icon} ${item.text}</span>
                    <span class="time">${item.time}</span>
                </div>
            `).join('');
        }

        function getAgentEmoji(name) {
            const emojis = {
                'Lumen': 'üîÆ',
                'Research': 'üîç',
                'Build': 'üî®',
                'Create': 'üé®',
                'FLUX-Gen': 'üñºÔ∏è',
                'SVD-Gen': 'üé¨'
            };
            return emojis[name] || 'ü§ñ';
        }

        // Update every 2 seconds
        fetchData();
        setInterval(fetchData, 2000);
    </script>
</body>
</html>
